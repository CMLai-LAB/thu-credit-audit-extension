<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>THU 必修科目表擷取器</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="wrap">
    <header class="app-header">
      <div class="title-group">
        <h1>必修科目表</h1>
        <p class="subtitle">快速查詢 / 比對學分 & 匯出報告</p>
      </div>
      <div class="header-actions">
        <button class="icon-btn" id="refreshYearsBtn" title="重新載入學年度" aria-label="重新載入學年度">↻</button>
      </div>
    </header>

    <section class="panel form-panel" aria-labelledby="formTitle">
      <h2 id="formTitle" class="visually-hidden">查詢條件</h2>
      <div class="grid form-grid">
        <label class="field">
          <span class="field-label">學年度</span>
          <select id="setyear" class="field-input"></select>
        </label>

        <label class="field">
          <span class="field-label">學制</span>
          <select id="stype" class="field-input">
            <option value="A" selected>日間學士班</option>
            <option value="D">博士班</option>
            <option value="E">進修學士班</option>
            <option value="G">碩士班</option>
          </select>
        </label>

        <label class="field">
          <span class="field-label">學系</span>
          <select id="majr" class="field-input"></select>
        </label>

        <label class="field">
          <span class="field-label">組別</span>
          <select id="subMajr" class="field-input"></select>
        </label>
      </div>

      <div class="btns" role="group" aria-label="操作按鈕">
        <button id="fetchBtn" class="btn primary">查詢</button>
        <button id="compareBtn" class="btn accent">學分比對</button>
        <button id="exportBtn" class="btn outline" disabled>匯出 CSV</button>
      </div>

      <div id="status" class="status" role="status" aria-live="polite"></div>
    </section>
  </div>

  <div class="wrap-row">
    <section id="rawPanel" class="panel" aria-labelledby="rawTitle" style="margin-top:16px;">
      <div class="panel-head">
        <h2 id="rawTitle">原始表格</h2>
      </div>
      <iframe id="rawFrame"
              class="raw-frame"
              sandbox="allow-popups allow-top-navigation-by-user-activation"></iframe>
    </section>

    <div id="result" class="result" style="display:none;"></div>
  </div>
    <footer class="footer">
      <small>ⓘ 若比對失敗，請先在原校務系統開啟「歷年成績」頁再重試。</small>
    </footer>


  <script src="popup.js"></script>
</body>
</html>