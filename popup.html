<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>THU 必修科目表擷取器</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="wrap">
    <h1>必修科目表</h1>

    <label>
      <p>學年度</p>
      <!-- 由 JS 動態塞入最新年度清單 -->
      <select id="setyear"></select>
    </label>

    <label>
      <p>學制</p>
      <select id="stype">
        <option value="A" selected>日間學士班</option>
        <option value="D">博士班</option>
        <option value="E">進修學士班</option>
        <option value="G">碩士班</option>
      </select>
    </label>

    <label>
      <p>學系</p>
      <select id="majr"></select>
    </label>

    <label id="subMajr">
    </label>

    <div class="btns">
      <button id="fetchBtn">查詢</button>
      <button id="compareBtn">學分比對</button>
      <button id="exportBtn" disabled>匯出 CSV</button>
    </div>

    <div id="status" class="status"></div>
    
    <!-- 原始表格（校方回傳 HTML 的預覽） -->
    <div id="rawPanel" style="margin-top:12px;">
      <div style="font-weight:600;margin-bottom:6px;">原始表格（校方回傳）</div>
      <iframe id="rawFrame"
              style="width:100%;height:520px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;"
              sandbox="allow-popups allow-top-navigation-by-user-activation"></iframe>
    </div>

    <div id="result" class="result" style="display:none;"></div>
  </div>

  <script src="popup.js"></script>
</body>
</html>